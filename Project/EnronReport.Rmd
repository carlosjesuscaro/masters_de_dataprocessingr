---
title: "Enron Report"
author: "Carlos Jesus Caro"
email: "carlos.jesus-caro@edu.dsti.institute"
class: "[A24] Big Data Processing with R"
date: "2025-09-14"
output: html_document
---

## Submission Details

* **Email:** `r rmarkdown::metadata$email`
* **Class:** `r rmarkdown::metadata$class`

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Summary

The purpose of this document is to show the analysis completed over the data sets included in the 'Rdata' file.

## Analysis
### Loading thhe data and the libraries

```{r}
library(tidyverse)
load('Enron.Rdata')
```

### Collecting the data sets as data frames
```{r}
employees <- as.data.frame(employeelist)
messages <- as.data.frame(message)
recipients <- as.data.frame(recipientinfo)
references <- as.data.frame(referenceinfo)
```


Identification of the variables within each data set
```{r}
employees_cols <- paste(colnames(employees), collapse = ", ")
sprintf("`employees` data frame column names: %s", employees_cols)

messages_cols <- paste(colnames(messages), collapse = ", ")
sprintf("`messages` data frame column names: %s", messages_cols)

recipients_cols <- paste(colnames(recipients), collapse = ", ")
sprintf("`recipients` data frame column names: %s", recipients_cols)

references_cols <- paste(colnames(references), collapse = ", ")
sprintf("`references` data frame column names: %s", references_cols)
```

Since every data frame has a unique ID, let's check if there are any duplicates.

First, let's define a function that returns the number of repeated values in a given data frame column.

```{r}
check_duplicates <- function(df, col_id) {
  rep <- df %>% 
    group_by({{ col_id }}) %>%
    count() %>%
    filter(n > 1) %>%
    nrow()
  return(rep)
}
```


```{r}
sprintf("Number of duplicated IDs in `employees` data frame: %d", check_duplicates(employees, eid))

sprintf("Number of duplicated IDs in `messages` data frame: %d", check_duplicates(messages, mid))

sprintf("Number of duplicated IDs in `recipients` data frame: %d", check_duplicates(recipients, rid))

sprintf("Number of duplicated IDs in `references` data frame: %d", check_duplicates(references, rfid))
```

