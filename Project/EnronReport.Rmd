---
title: "Enron Report"
author: "Carlos Jesus Caro"
email: "carlos.jesus-caro@edu.dsti.institute"
class: "[A24] Big Data Processing with R"
date: "2025-09-14"
output: html_document
---

## Submission Details

* **Email:** `r rmarkdown::metadata$email`
* **Class:** `r rmarkdown::metadata$class`

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Summary

The goal of this project is to perform a comprehensive data analysis of the datasets provided in the Rdata file. This report will highlight the effective application of a range of data manipulation, cleaning, and transformation skills. These techniques are essential for preparing raw data for analysis, a process that accounts for a significant portion of the effort in any data-driven project. The successful execution of these tasks will demonstrate proficiency in creating a robust and reproducible analytical workflow.

## Analysis
### Loading thhe data and the libraries

```{r}
library(tidyverse)
load('Enron.Rdata')
```

### Collecting the data sets as data frames
```{r}
employees <- as.data.frame(employeelist)
messages <- as.data.frame(message)
recipients <- as.data.frame(recipientinfo)
```

### Data inspection

Identification of the variables within each data set
```{r}
employees_cols <- paste(colnames(employees), collapse = ", ")
sprintf("`employees` data frame column names: %s", employees_cols)

messages_cols <- paste(colnames(messages), collapse = ", ")
sprintf("`messages` data frame column names: %s", messages_cols)

recipients_cols <- paste(colnames(recipients), collapse = ", ")
sprintf("`recipients` data frame column names: %s", recipients_cols)
```

Since every data frame has a unique ID, let's check if there are any duplicates.

First, let's define a function that returns the number of repeated values in a given data frame column.

```{r}
check_duplicates <- function(df, col_id) {
  rep <- df %>% 
    group_by({{ col_id }}) %>%
    count() %>%
    filter(n > 1) %>%
    nrow()
  return(rep)
}
```


```{r}
sprintf("Number of duplicated IDs in `employees` data frame: %d", check_duplicates(employees, eid))

sprintf("Number of duplicated IDs in `messages` data frame: %d", check_duplicates(messages, mid))

sprintf("Number of duplicated IDs in `recipients` data frame: %d", check_duplicates(recipients, rid))
```

### Data insights

When reviewing th data, the 4 data frames (employees, messages, recipients and references), this report will aim to answer the the following questions:

#### What is the difference in volume in messages in between the dates of October 31, 2001 and December 2, 2001 and the overall volume?

#### How is the volume distribution among the different employee's role?

#### Did the patterns of message type (TO, CC, BCC) changed over the date range of interest?


#### How can you show the difference in tone form the subject lines between the date range of interest?

